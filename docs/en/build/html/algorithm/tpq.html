
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.3. Finite-temperature calculations by the TPQ method &#8212; HPhi++ 3.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.4. Dynamical Green’s function" href="dynamical_green.html" />
    <link rel="prev" title="5.2. Full Diagonalization method" href="full_diag.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="dynamical_green.html" title="5.4. Dynamical Green’s function"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="full_diag.html" title="5.2. Full Diagonalization method"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">HPhi++ 3.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">5. Algorithm</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="finite-temperature-calculations-by-the-tpq-method">
<h1>5.3. Finite-temperature calculations by the TPQ method<a class="headerlink" href="#finite-temperature-calculations-by-the-tpq-method" title="Permalink to this headline">¶</a></h1>
<p>Sugiura and Shimizu showed that
it is possible to calculate the finite-temperature properties
from a few wavefunctions (in the thermodynamic limit, only one wave function is necessary) <a class="footnote-reference" href="#id3" id="id1">[1]</a> .
The wavefunction is called the thermal pure quantum (TPQ) state.
Because the TPQ state can be generated by operating the Hamiltonian
to the random initial wavefunction,
we directly use the routine Lanczos method for the TPQ calculations.
Here, we explain how to construct the micro canonical TPQ (mTPQ) state,
which offers the simplest method for calculating finite-temperature properties.</p>
<p>Let <span class="math">\(|\psi_{0}\rangle\)</span> be a random initial vector.
By operating <span class="math">\((l-\hat{\mathcal H }/N_{s})^{k}\)</span>(<span class="math">\(l\)</span> is constant and <span class="math">\(N_{s}\)</span> represents the number of sites)
to <span class="math">\(|\psi_{0}\rangle\)</span>,
we obtain the <span class="math">\(k\)</span>th TPQ states as</p>
<div class="math">
\[|\psi_{k}\rangle \equiv \frac{(l-\hat{\mathcal H }/N_{s})|\psi_{k-1}\rangle}{|(l-\hat{\mathcal H }/N_{s})|\psi_{k-1}\rangle|}.\]</div>
<p>From <span class="math">\(|\psi_{k}\rangle\)</span>, we estimate the corresponding inverse temperature <span class="math">\(\beta_{k}\)</span> as</p>
<div class="math">
\[\beta_{k}\sim \frac{2k/N_{s}}{l-u_{k}}, u_{k} = \langle \psi_{k}|\hat{\mathcal H }|\psi_{k}\rangle/N_{s},\]</div>
<p>where <span class="math">\(u_{k}\)</span> is the internal energy.
The arbitrary local physical properties at <span class="math">\(\beta_{k}\)</span> are also estimated as</p>
<div class="math">
\[\langle \hat{A}\rangle_{\beta_{k}} =  \langle \psi_{k}|\hat{A}|\psi_{k}\rangle/N_{s}.\]</div>
<p>In a finite-size system,
error is caused by the choice of the initial random vector.
To estimate the average value and error of the physical properties,
we perform some independent calculations by changing <span class="math">\(|\psi_{0}\rangle\)</span>.</p>
<div class="section" id="details-of-implementation">
<h2>5.3.1. Details of implementation<a class="headerlink" href="#details-of-implementation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="initial-vector">
<h3><strong>Initial vector</strong><a class="headerlink" href="#initial-vector" title="Permalink to this headline">¶</a></h3>
<p>For the TPQ method, the initial vector is given by using a random generator, i.e., the coefficients of all the components for the initial vector are given by random numbers. The seed is calculated as</p>
<div class="math">
\[123432+(n_{\rm run}+1)\times  |r_s|+k_{\rm Thread}+N_{\rm Thread} \times k_{\rm Process},\]</div>
<p>where <span class="math">\(r_s\)</span> is the number given by an input file and <span class="math">\(n_{\rm run}\)</span> is the number of runs. <span class="math">\(r_s\)</span> and the maximum value of <span class="math">\(n_{\rm run}\)</span> are defined by <code class="docutils literal"><span class="pre">initial_iv</span></code> and <code class="docutils literal"><span class="pre">NumAve</span></code> in an input file for Standard mode or a ModPara file for Expert mode, respectively. Random numbers are generated by using SIMD-oriented Fast Mersenne Twister (dSFMT) <a class="footnote-reference" href="#id4" id="id2">[2]</a> . We can select the type of initial vector as a real number or complex number by using <code class="docutils literal"><span class="pre">InitialVecType</span></code> in a ModPara file.
<span class="math">\(k_{\rm Thread}, N_{\rm Thread}, and k_{\rm Process}\)</span> indicate
the thread ID, number of threads, process ID, respectively;
the initial vector depends both on <code class="docutils literal"><span class="pre">initial_iv</span></code> and the number of parallelisms.</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>S. Sugiura, A. Shimizu, Phys. Rev. Lett. <strong>108</strong>, 240401 (2012).</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>http://www.math.sci.hiroshima-u.ac.jp/m-mat/MT/SFMT.</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/HPhi++.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.3. Finite-temperature calculations by the TPQ method</a><ul>
<li><a class="reference internal" href="#details-of-implementation">5.3.1. Details of implementation</a><ul>
<li><a class="reference internal" href="#initial-vector"><strong>Initial vector</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="full_diag.html"
                        title="previous chapter">5.2. Full Diagonalization method</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dynamical_green.html"
                        title="next chapter">5.4. Dynamical Green’s function</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/algorithm/tpq.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="dynamical_green.html" title="5.4. Dynamical Green’s function"
             >next</a> |</li>
        <li class="right" >
          <a href="full_diag.html" title="5.2. Full Diagonalization method"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">HPhi++ 3.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Algorithm</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, HPhi++ team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.
    </div>
  </body>
</html>